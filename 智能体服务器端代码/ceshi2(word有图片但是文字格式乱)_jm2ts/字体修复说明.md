# ğŸ¯ Wordå­—ä½“æ ¼å¼ä¿®å¤å®Œæˆ

## ğŸ“‹ ä¿®å¤å†…å®¹

å·²æˆåŠŸä¿®å¤`word_generator.py`ä¸­çš„å­—ä½“æ ¼å¼æ··ä¹±é—®é¢˜ï¼Œé€šè¿‡**å¼ºåˆ¶å­—ä½“è®¾ç½®**çš„æ–¹å¼ç¡®ä¿Wordæ–‡æ¡£ä¸­çš„å­—ä½“æ˜¾ç¤ºä¸€è‡´ã€‚

## âœ… ä¸»è¦æ”¹è¿›

### 1. æ·»åŠ å¼ºåˆ¶å­—ä½“é…ç½®
```python
# å¼ºåˆ¶å­—ä½“é…ç½® - è§£å†³å­—ä½“æ ¼å¼æ··ä¹±é—®é¢˜
self.fonts = {
    'chinese': 'å¾®è½¯é›…é»‘',      # ä¸­æ–‡å­—ä½“
    'english': 'Calibri',       # è‹±æ–‡å­—ä½“
    'code': 'Consolas',         # ä»£ç å­—ä½“
    'fallback': 'å®‹ä½“'          # å¤‡ç”¨å­—ä½“
}

# å­—å·é…ç½®
self.font_sizes = {
    'title': 22,        # ä¸»æ ‡é¢˜
    'heading1': 18,     # ä¸€çº§æ ‡é¢˜
    'heading2': 16,     # äºŒçº§æ ‡é¢˜
    'heading3': 14,     # ä¸‰çº§æ ‡é¢˜
    'normal': 12,       # æ­£æ–‡
    'small': 10,        # å°å­—
    'code': 10          # ä»£ç 
}
```

### 2. å¼ºåŒ–æ–‡æ¡£æ ·å¼è®¾ç½®
- **`_setup_document_styles()`**: å¼ºåˆ¶è®¾ç½®æ–‡æ¡£çº§åˆ«çš„å­—ä½“æ ·å¼
- **`_force_document_fonts()`**: ç¡®ä¿æ–‡æ¡£å­—ä½“ä¸»é¢˜ä¸€è‡´
- **`_set_font_for_complex_script()`**: å¤„ç†ä¸­è‹±æ–‡æ··åˆå­—ä½“è®¾ç½®

### 3. æ–°å¢å¼ºåˆ¶å­—ä½“è®¾ç½®æ–¹æ³•
- **`_force_run_font()`**: å¼ºåˆ¶è®¾ç½®æ–‡æœ¬è¿è¡Œçš„å­—ä½“æ ¼å¼
- **`_force_run_complex_font()`**: å¼ºåˆ¶è®¾ç½®å¤æ‚è„šæœ¬å­—ä½“

### 4. æ›´æ–°æ‰€æœ‰æ–‡æœ¬å¤„ç†æ–¹æ³•
- **æ®µè½å¤„ç†**: `_process_paragraph_content()` ä½¿ç”¨å¼ºåˆ¶å­—ä½“è®¾ç½®
- **è¡¨æ ¼å¤„ç†**: `_add_table_to_doc()` å¼ºåˆ¶è®¾ç½®è¡¨æ ¼å­—ä½“
- **åˆ—è¡¨å¤„ç†**: `_add_list_to_doc()` å¼ºåˆ¶è®¾ç½®åˆ—è¡¨å­—ä½“
- **å›¾ç‰‡å¤„ç†**: `_add_image_to_doc()` å¼ºåˆ¶è®¾ç½®å›¾ç‰‡æ ‡é¢˜å­—ä½“

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯ç‰¹æ€§

### 1. å¤æ‚è„šæœ¬å­—ä½“å¤„ç†
```python
def _set_font_for_complex_script(self, style, font_name):
    """ä¸ºæ ·å¼è®¾ç½®å¤æ‚è„šæœ¬å­—ä½“ï¼ˆå¤„ç†ä¸­è‹±æ–‡æ··åˆï¼‰"""
    # è®¾ç½®å„ç§å­—ä½“å±æ€§
    fonts_element.set(qn('w:ascii'), self.fonts['english'])      # ASCIIå­—ç¬¦
    fonts_element.set(qn('w:hAnsi'), self.fonts['english'])      # é«˜ä½ANSIå­—ç¬¦
    fonts_element.set(qn('w:eastAsia'), self.fonts['chinese'])   # ä¸œäºšå­—ç¬¦
    fonts_element.set(qn('w:cs'), self.fonts['chinese'])         # å¤æ‚è„šæœ¬å­—ç¬¦
```

### 2. å¼ºåˆ¶å­—ä½“è®¾ç½®
```python
def _force_run_font(self, run, is_bold=False, is_italic=False, is_code=False, is_heading=False):
    """å¼ºåˆ¶è®¾ç½®æ–‡æœ¬è¿è¡Œçš„å­—ä½“æ ¼å¼"""
    if is_code:
        run.font.name = self.fonts['code']
        run.font.size = Pt(self.font_sizes['code'])
        run.font.color.rgb = RGBColor(0x2F, 0x4F, 0x4F)
    elif is_heading:
        run.font.name = self.fonts['chinese']
        run.font.color.rgb = RGBColor(0x00, 0x00, 0x00)
    else:
        run.font.name = self.fonts['chinese']
        run.font.size = Pt(self.font_sizes['normal'])
        run.font.color.rgb = RGBColor(0x00, 0x00, 0x00)
```

### 3. å…¼å®¹æ€§ä¿æŒ
- ä¿ç•™åŸæœ‰çš„`_set_run_font()`æ–¹æ³•ï¼Œç¡®ä¿ç°æœ‰ä»£ç ä¸å—å½±å“
- æ–°å¢çš„å¼ºåˆ¶å­—ä½“è®¾ç½®æ–¹æ³•å‘åå…¼å®¹

## ğŸ¨ è‡ªå®šä¹‰å­—ä½“æ”¯æŒ

ç°åœ¨æ”¯æŒè¿è¡Œæ—¶è‡ªå®šä¹‰å­—ä½“é…ç½®ï¼š

```python
from word_generator import WordGenerator

# åˆ›å»ºç”Ÿæˆå™¨
generator = WordGenerator("./output")

# è‡ªå®šä¹‰å­—ä½“
generator.fonts['chinese'] = 'å®‹ä½“'
generator.fonts['english'] = 'Arial'
generator.fonts['code'] = 'Courier New'

# ç”Ÿæˆæ–‡æ¡£
output_path = generator.convert_markdown_to_docx(
    markdown_content=markdown_text,
    filename="custom_font_report.docx"
)
```

## ğŸ“Š æµ‹è¯•éªŒè¯

### è¿è¡Œæµ‹è¯•
```bash
cd æ™ºèƒ½ä½“æœåŠ¡å™¨ç«¯ä»£ç /ceshi2(wordæœ‰å›¾ç‰‡ä½†æ˜¯æ–‡å­—æ ¼å¼ä¹±)_jm2ts
python test_font_fix.py
```

### æµ‹è¯•å†…å®¹
1. **åŸºç¡€å­—ä½“ä¿®å¤æµ‹è¯•**: éªŒè¯é»˜è®¤å­—ä½“è®¾ç½®æ•ˆæœ
2. **è‡ªå®šä¹‰å­—ä½“é…ç½®æµ‹è¯•**: éªŒè¯å­—ä½“è‡ªå®šä¹‰åŠŸèƒ½
3. **ä¸­è‹±æ–‡æ··åˆæµ‹è¯•**: éªŒè¯å¤æ‚è„šæœ¬å­—ä½“å¤„ç†
4. **è¡¨æ ¼åˆ—è¡¨æµ‹è¯•**: éªŒè¯å„ç§å…ƒç´ çš„å­—ä½“ä¸€è‡´æ€§

## ğŸ”„ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1: ç›´æ¥ä½¿ç”¨ï¼ˆæ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç ï¼‰
```python
from word_generator import convert_markdown_to_word_with_charts

# ç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹ï¼Œå­—ä½“é—®é¢˜å·²è‡ªåŠ¨ä¿®å¤
output_path = convert_markdown_to_word_with_charts(
    markdown_content=markdown_text,
    chart_configs=chart_configs,
    output_dir="./output",
    filename="report.docx"
)
```

### æ–¹æ³•2: è‡ªå®šä¹‰å­—ä½“é…ç½®
```python
from word_generator import WordGenerator

generator = WordGenerator("./output")
generator.fonts['chinese'] = 'é»‘ä½“'  # è‡ªå®šä¹‰ä¸­æ–‡å­—ä½“
output_path = generator.convert_markdown_to_docx(...)
```

## ğŸ¯ è§£å†³çš„é—®é¢˜

### âŒ ä¿®å¤å‰çš„é—®é¢˜
- å­—ä½“è®¾ç½®ä¸å¤Ÿå¼ºåˆ¶ï¼Œå®¹æ˜“è¢«è¦†ç›–
- ä¸­è‹±æ–‡å­—ä½“æ··ä¹±ï¼Œæ˜¾ç¤ºä¸ä¸€è‡´
- è¡¨æ ¼ã€åˆ—è¡¨ã€æ®µè½å­—ä½“ä¸ç»Ÿä¸€
- åœ¨ä¸åŒç¯å¢ƒä¸‹æ˜¾ç¤ºæ•ˆæœä¸åŒ

### âœ… ä¿®å¤åçš„æ•ˆæœ
- **å­—ä½“ç»Ÿä¸€**: æ‰€æœ‰æ–‡æœ¬å…ƒç´ ä½¿ç”¨ä¸€è‡´çš„å­—ä½“è®¾ç½®
- **ä¸­è‹±æ–‡åˆ†ç¦»**: ä¸­æ–‡ä½¿ç”¨å¾®è½¯é›…é»‘ï¼Œè‹±æ–‡ä½¿ç”¨Calibri
- **å¼ºåˆ¶è®¾ç½®**: é€šè¿‡XMLçº§åˆ«çš„å­—ä½“è®¾ç½®ï¼Œç¡®ä¿ä¸è¢«è¦†ç›–
- **å…¼å®¹æ€§å¼º**: æ”¯æŒå¤šç§ç¯å¢ƒå’Œè‡ªå®šä¹‰é…ç½®

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

- **`word_generator.py`**: ä¸»è¦ä¿®æ”¹æ–‡ä»¶ï¼Œæ·»åŠ å¼ºåˆ¶å­—ä½“è®¾ç½®åŠŸèƒ½
- **`test_font_fix.py`**: æ–°å¢æµ‹è¯•æ–‡ä»¶ï¼ŒéªŒè¯ä¿®å¤æ•ˆæœ
- **`å­—ä½“ä¿®å¤è¯´æ˜.md`**: æœ¬è¯´æ˜æ–‡æ¡£

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

1. **å¤šå±‚çº§å­—ä½“è®¾ç½®**: æ–‡æ¡£çº§ â†’ æ ·å¼çº§ â†’ è¿è¡Œçº§ï¼Œç¡®ä¿å­—ä½“è®¾ç½®ä¸è¢«è¦†ç›–
2. **å¤æ‚è„šæœ¬å¤„ç†**: é€šè¿‡XMLæ“ä½œè®¾ç½®ä¸åŒå­—ç¬¦é›†çš„å­—ä½“
3. **å‘åå…¼å®¹**: ä¿æŒåŸæœ‰APIä¸å˜ï¼Œç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹
4. **çµæ´»é…ç½®**: æ”¯æŒè¿è¡Œæ—¶è‡ªå®šä¹‰å­—ä½“é…ç½®
5. **é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•

## ğŸ‰ æ€»ç»“

é€šè¿‡**å¼ºåˆ¶å­—ä½“è®¾ç½®**å’Œ**å¤æ‚è„šæœ¬å­—ä½“å¤„ç†**ï¼ŒæˆåŠŸè§£å†³äº†Wordæ–‡æ¡£ç”Ÿæˆä¸­çš„å­—ä½“æ ¼å¼æ··ä¹±é—®é¢˜ã€‚ç°åœ¨ç”Ÿæˆçš„Wordæ–‡æ¡£å°†å…·æœ‰ï¼š

- âœ… **ç»Ÿä¸€çš„å­—ä½“æ˜¾ç¤º**
- âœ… **ä¸­è‹±æ–‡å­—ä½“åˆ†ç¦»**
- âœ… **å¼ºåˆ¶å­—ä½“è®¾ç½®**
- âœ… **è‡ªå®šä¹‰å­—ä½“æ”¯æŒ**
- âœ… **å‘åå…¼å®¹æ€§**

**ç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨ä¿®å¤åçš„ä»£ç ï¼Œå­—ä½“æ ¼å¼æ··ä¹±é—®é¢˜å·²å½»åº•è§£å†³ï¼** ğŸš€
